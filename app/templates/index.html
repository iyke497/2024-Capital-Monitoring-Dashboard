{% extends "layout.html" %}

{% block title %}Survey Dashboard{% endblock %}
{% block header %}Data Ingestion Dashboard{% endblock %}

{% block content %}
<div class="controls">
    <div style="display: flex; align-items: center; gap: 15px;">
        <span id="last-updated" style="color: #666; font-size: 14px; font-weight: 500;">
            Last updated: Checking...
        </span>
        <span id="next-update" style="color: #999; font-size: 13px;">
            Next update: Checking...
        </span>
    </div>
    <div id="update-status" style="margin-top: 10px; padding: 8px 12px; background: #f0f0f0; border-radius: 4px; font-size: 13px; display: none;">
        <span id="status-icon">‚è≥</span>
        <span id="status-text">Updating...</span>
    </div>
</div>

<div class="overview-grid">
    <div class="card stats-card">
        <h3>Total Responses</h3>
        <div id="total-responses" class="stat-val">0</div>
        <div class="stat-breakdown">
            <div class="breakdown-item">
                <span class="breakdown-label">Survey 1:</span>
                <span id="survey1-count" class="breakdown-val">0</span>
            </div>
            <div class="breakdown-item">
                <span class="breakdown-label">Survey 2:</span>
                <span id="survey2-count" class="breakdown-val">0</span>
            </div>
        </div>
    </div>
    
    <div class="card chart-card">
        <h3>2024 Budget Project Reporting</h3>
        <div class="chart-container">
            <canvas id="budgetChart"></canvas>
        </div>
    </div>
</div>

<div class="card table-card">
    <h3>Recent Project Responses</h3>
    <table id="responses-table" class="display" style="width:100%">
        <thead>
            <tr>
                <th>Project Name</th>
                <th>ERGP Code</th>
                <th>MDA</th>
                <th>% Done</th>
                <th>Appropriation</th>
            </tr>
        </thead>
    </table>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}